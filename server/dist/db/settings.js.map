{"version":3,"file":"settings.js","sources":["db/settings.ts"],"sourceRoot":"/","sourcesContent":["// LowDB, stores the schedules in /persistent/free-sleep-data/lowdb/settingsDB.json\nimport _ from 'lodash';\nimport { Low } from 'lowdb';\nimport { JSONFile } from 'lowdb/node';\n\nimport { Settings, SideSettings } from './settingsSchema.js';\nimport config from '../config.js';\n\nconst defaultSideSettings: SideSettings = {\n  name: 'Side',\n  awayMode: false,\n  scheduleOverrides: {\n    temperatureSchedules: {\n      disabled: false,\n      expiresAt: ''\n    },\n    alarm: {\n      disabled: false,\n      timeOverride: '',\n      expiresAt: '',\n    }\n  },\n  taps: {\n    doubleTap: {\n      type: 'temperature',\n      change: 'decrement',\n      amount: 1,\n    },\n    tripleTap: {\n      type: 'temperature',\n      change: 'increment',\n      amount: 1,\n    },\n    quadTap: {\n      type: 'alarm',\n      behavior: 'dismiss',\n      snoozeDuration: 60,\n      inactiveAlarmBehavior: 'power',\n    },\n  }\n};\n\nconst defaultData: Settings = {\n  id: crypto.randomUUID(),\n  timeZone: 'UTC',\n  temperatureFormat: 'fahrenheit',\n  rebootDaily: true,\n  left: {\n    ..._.cloneDeep(defaultSideSettings),\n    name: 'Left',\n  },\n  right: {\n    ..._.cloneDeep(defaultSideSettings),\n    name: 'Right',\n  },\n  primePodDaily: {\n    enabled: false,\n    time: '14:00',\n  },\n};\n\nconst file = new JSONFile<Settings>(`${config.lowDbFolder}settingsDB.json`);\nconst settingsDB = new Low<Settings>(file, defaultData);\nawait settingsDB.read();\n// Allows us to add default values to the settings if users have existing settingsDB.json data\nsettingsDB.data = _.merge({}, defaultData, settingsDB.data);\nawait settingsDB.write();\n\nexport default settingsDB;\n"],"names":[],"mappings":"AAAA,mFAAmF;;;AACnF,OAAO,CAAC,MAAM,QAAQ,CAAC;AACvB,OAAO,EAAE,GAAG,EAAE,MAAM,OAAO,CAAC;AAC5B,OAAO,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AAGtC,OAAO,MAAM,MAAM,cAAc,CAAC;AAElC,MAAM,mBAAmB,GAAiB;IACxC,IAAI,EAAE,MAAM;IACZ,QAAQ,EAAE,KAAK;IACf,iBAAiB,EAAE;QACjB,oBAAoB,EAAE;YACpB,QAAQ,EAAE,KAAK;YACf,SAAS,EAAE,EAAE;SACd;QACD,KAAK,EAAE;YACL,QAAQ,EAAE,KAAK;YACf,YAAY,EAAE,EAAE;YAChB,SAAS,EAAE,EAAE;SACd;KACF;IACD,IAAI,EAAE;QACJ,SAAS,EAAE;YACT,IAAI,EAAE,aAAa;YACnB,MAAM,EAAE,WAAW;YACnB,MAAM,EAAE,CAAC;SACV;QACD,SAAS,EAAE;YACT,IAAI,EAAE,aAAa;YACnB,MAAM,EAAE,WAAW;YACnB,MAAM,EAAE,CAAC;SACV;QACD,OAAO,EAAE;YACP,IAAI,EAAE,OAAO;YACb,QAAQ,EAAE,SAAS;YACnB,cAAc,EAAE,EAAE;YAClB,qBAAqB,EAAE,OAAO;SAC/B;KACF;CACF,CAAC;AAEF,MAAM,WAAW,GAAa;IAC5B,EAAE,EAAE,MAAM,CAAC,UAAU,EAAE;IACvB,QAAQ,EAAE,KAAK;IACf,iBAAiB,EAAE,YAAY;IAC/B,WAAW,EAAE,IAAI;IACjB,IAAI,EAAE;QACJ,GAAG,CAAC,CAAC,SAAS,CAAC,mBAAmB,CAAC;QACnC,IAAI,EAAE,MAAM;KACb;IACD,KAAK,EAAE;QACL,GAAG,CAAC,CAAC,SAAS,CAAC,mBAAmB,CAAC;QACnC,IAAI,EAAE,OAAO;KACd;IACD,aAAa,EAAE;QACb,OAAO,EAAE,KAAK;QACd,IAAI,EAAE,OAAO;KACd;CACF,CAAC;AAEF,MAAM,IAAI,GAAG,IAAI,QAAQ,CAAW,GAAG,MAAM,CAAC,WAAW,iBAAiB,CAAC,CAAC;AAC5E,MAAM,UAAU,GAAG,IAAI,GAAG,CAAW,IAAI,EAAE,WAAW,CAAC,CAAC;AACxD,MAAM,UAAU,CAAC,IAAI,EAAE,CAAC;AACxB,8FAA8F;AAC9F,UAAU,CAAC,IAAI,GAAG,CAAC,CAAC,KAAK,CAAC,EAAE,EAAE,WAAW,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC;AAC5D,MAAM,UAAU,CAAC,KAAK,EAAE,CAAC;AAEzB,eAAe,UAAU,CAAC","debug_id":"0261ea34-41c4-5b3f-832d-760b82ced4c3"}